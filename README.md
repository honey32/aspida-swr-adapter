# Aspida-SWR Adapter

Provides **one function**, which adapt 

- **api definition** generated by [aspida](https://github.com/aspida/aspida) 
- with **hooks** provided by [@vercel/swr](https://github.com/vercel/swr)

This enables [Conditional or Depentent Fetching](https://swr.vercel.app/docs/conditional-fetching) in easy, DRY, and null-safe way.

## Quick Start

```tsx
const { value: userId } = useIntParam("userId");

const router = useRouter();
const token = router.query.token;

const [getKey, fetcher] = aspidaToSWR(
  userId !== undefined &&
    apiClient.users._userId(userId).posts,
  "$get",
  isValidToken(token) &&
    ([token] as const)
).params<[page: number]>(
  (fn, token, page) => fn({ query: { token, page } })
);

const { data: pagesData, setSize } = useSWRInfinite(
  (pageIndex) => getKey(pageIndex),
  fetcher,
  { initialSize: 2 }
);

```

## Examples

In [`examples/next-swr`](examples/next-swr) subproject, You can find some example code (using Next.js) like below.

### with `useSWR`
[`src/pages/users/[userId]/index.page.tsx`](examples/next-swr/src/pages/users/%5BuserId%5D/index.page.tsx)

### with `useSWRInfinite`
[`src/pages/users/[userId]/posts/index.page.tsx`](examples/next-swr/src/pages/users/%5BuserId%5D/posts/index.page.tsx)
